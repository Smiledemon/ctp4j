package com.ctp.dao;

import java.util.List;

import org.springframework.data.domain.Sort;
import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.data.mongodb.core.query.Criteria;
import org.springframework.data.mongodb.core.query.Query;

import com.ctp.data.entity.OHLCDataItem;

public class OHLCDataDaoImpl implements OHLCDataDao{
	
	private MongoTemplate mongoTemplate;
	
	public <T extends OHLCDataItem> List<T> getList(Class<T> clazz,String instrumentId,long start,long end){
		return mongoTemplate.find(new Query().addCriteria(Criteria.where("instrumentId").is(instrumentId).and("id").gte(start).lte(end)),clazz);
	}
	public <T extends OHLCDataItem> List<T> getList(Class<T> clazz,String instrumentId,long start,long end,int count){
		return mongoTemplate.find(new Query().addCriteria(Criteria.where("instrumentId").is(instrumentId).and("id").gte(start).lte(end)).limit(count).with(new Sort(Sort.Direction.ASC, "id")), clazz);
	}
	public void setMongoTemplate(MongoTemplate mongoTemplate) {
		this.mongoTemplate = mongoTemplate;
	}
	
	@Override
	public void save(OHLCDataItem data) {
		this.mongoTemplate.save(data);
	}

}
